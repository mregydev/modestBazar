<header class="header">
  <div class="header-content">
    <a routerLink="/" class="logo">
      <img src="/logo.png" alt="ModestBazar Logo" class="logo-image" />
      <span class="logo-text">ModestBazar</span>
    </a>

    @if (!shouldHideSearchBar()) {
      <div class="search-bar">
        <input
          type="text"
          [placeholder]="translate('header.search.placeholder')"
          [value]="searchQuery()"
          (input)="searchQuery.set($any($event.target).value)"
          (keyup.enter)="onSearch()"
          class="search-input"
        />
        <button type="button" (click)="onSearch()" class="search-button">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    }

    <nav class="nav">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">{{ translate('header.products') }}</a>
      @if (authStore.isLoggedIn()) {
        <a routerLink="/checkout" routerLinkActive="active">{{ translate('checkout.title') }}</a>
      }
      @if (!authStore.isLoggedIn() && !storeOwnerAuth.isLoggedIn()) {
        <div class="header-actions">
          <a routerLink="/login" class="auth-link">{{ translate('header.login') }}</a>
          <div class="language-selector">
            <button class="language-button" type="button" (click)="toggleLanguageDropdown()" [attr.aria-label]="translate('header.language.select')">
              <span class="flag-icon" [ngClass]="getCurrentLanguageFlagClass()"></span>
            </button>
            @if (showLanguageDropdown()) {
              <div class="language-dropdown">
                @for (lang of languages; track lang.code) {
                  <button
                    class="language-option"
                    [class.active]="currentLanguage() === lang.code"
                    (click)="selectLanguage(lang.code)"
                    type="button"
                  >
                    <span class="flag-icon" [ngClass]="lang.flagClass"></span>
                    <span class="language-name">{{ lang.name }}</span>
                  </button>
                }
              </div>
            }
          </div>
        </div>
      }
      <!-- Store Owner Links -->
      @if (storeOwnerAuth.isLoggedIn()) {
        @if (getMyStoreSlug()) {
          <a [routerLink]="['/stores', getMyStoreSlug()]" class="store-link">{{ translate('header.store.my') }}</a>
        }
        <button class="btn-logout" (click)="onStoreOwnerLogout()">{{ translate('header.logout') }}</button>
        <div class="language-selector">
          <button class="language-button" type="button" (click)="toggleLanguageDropdown()" [attr.aria-label]="translate('header.language.select')">
            <span class="flag-icon" [ngClass]="getCurrentLanguageFlagClass()"></span>
          </button>
          @if (showLanguageDropdown()) {
            <div class="language-dropdown">
              @for (lang of languages; track lang.code) {
                <button
                  class="language-option"
                  [class.active]="currentLanguage() === lang.code"
                  (click)="selectLanguage(lang.code)"
                  type="button"
                >
                  <span class="flag-icon" [ngClass]="lang.flagClass"></span>
                  <span class="language-name">{{ lang.name }}</span>
                </button>
              }
            </div>
          }
        </div>
      }
    </nav>

    @if (authStore.isLoggedIn()) {
      <div class="auth-section">
        <span class="user-greeting">{{ translate('header.greeting', {name: authStore.user()?.name || ''}) }}</span>
        <button class="btn-logout" (click)="authStore.logout()">{{ translate('header.logout') }}</button>
        <div class="language-selector">
          <button class="language-button" type="button" (click)="toggleLanguageDropdown()" [attr.aria-label]="translate('header.language.select')">
            <span class="flag-icon" [ngClass]="getCurrentLanguageFlagClass()"></span>
          </button>
          @if (showLanguageDropdown()) {
            <div class="language-dropdown">
              @for (lang of languages; track lang.code) {
                <button
                  class="language-option"
                  [class.active]="currentLanguage() === lang.code"
                  (click)="selectLanguage(lang.code)"
                  type="button"
                >
                  <span class="flag-icon" [ngClass]="lang.flagClass"></span>
                  <span class="language-name">{{ lang.name }}</span>
                </button>
              }
            </div>
          }
        </div>
      </div>
    }
  </div>
</header>
